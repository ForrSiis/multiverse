<h1><%= link_to @cardset.name, @cardset %>: Recent Activity</h1>
<% @title = @cardset.name + ": Recent Activity" %>

<%= render "setviews" %>

<% kinds_to_not_show = Log.kinds_to_not_show(:cardset_recent)
   items_to_show = @cardset.logs.reject{ |l| kinds_to_not_show.include?(l.kind) }.paginate :page => params[:page] || 1, :per_page => 50 %>

<p>
  <% if !items_to_show.empty? %>
    Recent updates to <%= @cardset.name %>: <span class="helptext">(Generated at <%= format_datetime_absolute Time.now %>)</span>

    <%= will_paginate items_to_show  %>

    <ul class="commentlist compact">
      <% items_to_show.each do |@log| %>
        <li class="recent_item">
          <%= render :partial => "shared/log_entry", :locals => { :link_to_recent => false } %>
          <% if @log.comment? && !kinds_to_not_show.include?(@log.kind) %>
            <% @comment = Comment.find_by_id(@log.object_id) %>
            <% if @comment && @comment.get_cardset == @cardset %>
              <%= render :partial => "shared/comment", :locals => { :show_buttons => true, :show_date => false } %>
            <% end %>
          <% end %>
      <% end %>
    </ul>

    <%= will_paginate items_to_show %>
  <% else %>
    There are no cards in <%= @cardset.name %>. There's been no activity.
  <% end %>
</div>

<%= link_to "See other cardsets", cardsets_path %>
